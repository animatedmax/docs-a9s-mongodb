<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      Using a9s MongoDB for PCF |
    
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  <script>
//Global Google Search
(function() {
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + '';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
})();
</script>

<script type="text/javascript">
  if (window.location.host === 'hello') {
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', '']);
    _gaq.push(['_setDomainName', '']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
    })();
  }
</script>

<script type="text/javascript">
  var blackList = ['acceptance'];

  blackList.forEach(function(blackListedEnv) {
    if (document.URL.indexOf(blackListedEnv) > -1 && blackListedEnv != "") {
      $('head').append('<meta name="hashtag" content="PivotalMoment">');
    }
  });
</script>

<!-- CrazyEgg Tracking Script -->
<script type="text/javascript">
  setTimeout(function() {
    var a = document.createElement("script");
    var b = document.getElementsByTagName("script")[0];
    a.src = document.location.protocol + "//script.crazyegg.com/pages/scripts/0020/8294.js?" + Math.floor(new Date().getTime() / 3600000);
    a.async = true;
    a.type = "text/javascript";
    b.parentNode.insertBefore(a, b)
  }, 1);
</script>

<script type="text/javascript">
  (function() {
    var didInit = false;

    function initMunchkin() {
      if (didInit === false) {
        didInit = true;
        Munchkin.init('625-IUJ-009');
      }
    }

    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
    s.onreadystatechange = function() {
      if (this.readyState == 'complete' || this.readyState == 'loaded') {
        initMunchkin();
      }
    };
    s.onload = initMunchkin;
    document.getElementsByTagName('head')[0].appendChild(s);
  })();
</script>

</head>

<body class="a9s-mongodb a9s-mongodb_using has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "";
    </script>

       
    <header class="header header-layout">
      <h1 class="logo">
        <a href="/">Default Book Title</a>
      </h1>
      
      <div class="header-links js-bar-links">
        <div class="btn-menu" data-behavior="MenuMobile"></div>
        
        <div class="header-item">
          
        </div>
        <!--Default search-->
<!--If book needs something different, add a book-search partial to the book's layouts folder-->
<div class="header-item searchbar js-searchbar">
  <a class="search-icon" data-behavior="Search"></a>
  <div class="search-input">
    <div class="search-input-inner" id="docs-search">
        <gcse:searchbox></gcse:searchbox>
    </div>
  </div>
</div>

      </div>
    </header>



    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="js-sidenav nav-container" role="navigation">
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    <ul>
      <li>
        <a id='home-nav-link' href="/a9s-mongodb/index.html">a9s MongoDB for PCF</a>
      </li>
      <li>
        <a href="/a9s-mongodb/installing.html">Installing and Configuring a9s MongoDB for PCF</a>
      </li>

      <li>
        <a href="/a9s-mongodb/using.html">Using a9s MongoDB for PCF</a>
      </li>

      <li>
        <a href="/a9s-mongodb/release-notes.html">a9s MongoDB for PCF Release Notes</a>
      </li>
    </ul>
  </div>
</div><!--end of sub-nav-->

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" >
    Using a9s MongoDB for PCF
  </h1>

          <div id="js-quick-links" >
            <div class="quick-links"><ul>
<li><a href="#using">Use a a9s MongoDB for PCF with an Application</a></li>
<li><a href="#credentials">Obtain Service Instance Access Credentials</a></li>
<li><a href="#deleting">Delete an a9s MongoDB for PCF Service Instance</a></li>
</ul></div>
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        <p>This topic describes how to use a9s MongoDB for PCF after it has been successfully installed. For more information, see <a href="/a9s-mongodb/installing.html">Installing and Configuring a9s MongoDB for PCF</a></p>

<h2><a id='using'></a>Use a a9s MongoDB for PCF with an Application</h2>

<p>To use a9s MongoDB for PCF with an application, create a service instance and bind the service instance
to your application. For more information on managing service instances, see <a href="https://docs.cloudfoundry.org/devguide/services/managing-services.html" target="_blank">Managing Service 
Instances with the CLI</a>.</p>

<h3>View the a9s MongoDB for PCF Service</h3>

<p>After the tile is installed, you can see the <em>a9s-mongodb</em> and its service
plans appear in your PCF marketplace. Run <code>cf marketplace</code> to
see the service listing:
<pre class="terminal">
$ cf marketplace
Getting services from marketplace in org test / space test as admin...
OK</p>

<p>service      plans                                           description<br>
a9s-mongodb  mongodb-single-small, mongodb-cluster-small,    This is the anynines mongodb 32 service. 
             mongodb-single-big, mongodb-cluster-big<br>
</pre></p>

<p>You can create MongoDB service instances based on the following service plans:</p>

<ul>
<li>mongodb-single-small: provisions a single-VM MongoDB server.</li>
<li>mongodb-cluster-small: provisions a MongoDB cluster service running on three VMs.</li>
<li>mongodb-single-big:</li>
<li>mongodb-cluster-big:</li>
</ul>

<h3>Create a Service Instance</h3>

<p>To provision a MongoDB database, run <code>cf create-service</code>, for example:</p>

<pre class="terminal">
$ cf create-service a9s-mongodb mongodb-single-small my-mongodb-service
</pre>

<p>Depending on your infrastructure and service broker utilization, it may take several minutes to create the service instance.</p>

<p>Check the creation status using <code>cf services</code>. This displays a list of all your service instances. To check the status of a specific service instance, 
run <code>cf service NAME-OF-YOUR-SERVICE</code>.</p>

<h3>Bind an Application to a Service Instance</h3>

<p>After your database is created, run <code>cf bind-service</code> to bind the service to your application:</p>

<pre class="terminal">
$ cf bind-service a9s-mongodb-app my-mongodb-service
</pre>

<h3>Restage or Restart Your Application</h3>

<p>To enable your application to access the service instance, run <code>cf restage</code> or <code>cf restart</code> to restage or restart your application.</p>

<h2><a id='credentials'></a> Obtain Service Instance Access Credentials</h2>

<p>After a service instance is bound to an application, the credentials of your MongoDB
database is stored in the environment variables of the application. Run <code>cf env APP-NAME</code> to display the environment variables. </p>

<p>The credentials can be found under
the <a href="https://docs.cloudfoundry.org/devguide/deploy-apps/environment-variable.html#VCAP-SERVICES" target="_blank">VCAP_SERVICES</a> key.</p>

<pre class="terminal">
$ cf env a9s-mongodb-app
Getting env variables for app a9s-mongodb-app in org test / space test as admin...
OK

System-Provided:
{
 "VCAP_SERVICES": {
  "a9s-mongodb": [
   {
    "credentials": {
     "default_database": "d22906",
     "hosts": [
      "EXAMPLE-HOST"
     ],
     "password": "EXAMPLE-PASSWORD",
     "uri": "EXAMPLE-URI",
     "username": "EXAMPLE-USERNAME"
    },
    "label": "a9s-mongodb",
    "name": "my-mongodb-service",
    "plan": "mongodb-single-small",
    "tags": [
     "nosql",
     "database",
     "document store",
     "eventual consistent"
    ]
   }
  ]
 }
}
...
</pre>

<p>You can use the host, username and password values to connect to your database with a MongoDB client.</p>

<h2><a id='deleting'></a> Delete an a9s MongoDB for PCF Service Instance</h2>

<p class="note">Before deleting a service instance, you must backup data stored in your database. This operation cannot be undone and all the data is lost when the service is deleted.</p>

<p>Before you can delete a service instance, it needs to be unbound from all applications.</p>

<h3>List Available Services</h3>

<p>Run <code>cf service</code> to list your available services.</p>

<pre class="terminal">
$ cf service                                                                                                                                               

Getting services in org test / space test as admin...
OK

name                 service       plan                   bound apps        last operation
my-mongodb-service   a9s-mongodb   mongodb-single-small   a9s-mongodb-app   create succeeded
</pre>

<p>This example shows that <code>my-mongodb-service</code> is bound to the <code>a9s-mongodb-app</code> application.</p>

<h3>Unbind a Service Instance</h3>

<p>Run <code>cf unbind-service</code> to unbind the service from your application.</p>

<pre class="terminal">
$ cf unbind-service a9s-mongodb-app my-mongodb-service
</pre>

<h3>Delete a Service Instance</h3>

<p>After unbinding the service, it is no longer bound to an application. Run <code>cf delete-service</code> to delete the service:</p>

<pre class="terminal">
$ cf delete-service my-mongodb-service
</pre>

<p>It may take several minutes to delete the service. Deleting a service deprovisions the corresponding infrastructure resources.
Run the <code>cf services</code> command to check the deletion status.</p>

          <gcse:searchresults></gcse:searchresults>


      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
  <a href='http://pivotal.io/privacy-policy'>Privacy Policy</a> | 
  <a href='http://pivotal.io/terms-of-use'>Terms of Use</a><br/>
  <a href='/'>Pivotal Documentation</a>
  &copy; 2016 <a href='http://pivotal.io'>Pivotal Software</a>, Inc. All Rights Reserved.
</div>
<div class="support">
  Need help? <a href="" target="_blank">Visit Support</a>
</div>

  </footer>
</div><!--end of container-->

</body>
</html>
